<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>預約系統</title>
  <style>
    /* 美化前台預約鍵 */
    .book-btn {
      padding: 9px 22px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(90deg,#2ecc71 60%,#27ae60 100%);
      color: #fff;
      font-size: 1.08rem;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 2px 8px #e3eaf3;
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
    }
    .book-btn:hover {
      background: linear-gradient(90deg,#27ae60 60%,#2ecc71 100%);
      box-shadow: 0 4px 16px #b3d1f7;
      transform: translateY(-2px) scale(1.04);
    }
    /* 美化 admin-panel 及 admin-section 內所有 select */
    #admin-panel select,
    .admin-section select {
      padding: 10px 16px;
      border: 1px solid #bfc9d1;
      border-radius: 6px;
      font-size: 1rem;
      background: linear-gradient(90deg,#f8fafc 60%,#e3eaf3 100%);
      color: #333;
      margin: 4px 0;
      box-shadow: 0 1px 2px #eee;
      transition: border-color 0.2s, box-shadow 0.2s, background 0.2s;
      outline: none;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      cursor: pointer;
    }
    #admin-panel select:focus,
    .admin-section select:focus {
      border-color: #3498db;
      box-shadow: 0 2px 8px #cce6ff;
      background: linear-gradient(90deg,#e3eaf3 60%,#f8fafc 100%);
    }
    /* 美化 admin-panel 內所有 button（分頁導航、返回首頁、表單送出鍵） */
    #admin-panel button,
    #admin-panel input[type="submit"] {
      padding: 10px 22px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(90deg,#3498db 60%,#2980b9 100%);
      color: #fff;
      font-size: 1.08rem;
      font-weight: 500;
      cursor: pointer;
      margin: 8px 0;
      box-shadow: 0 2px 8px #e3eaf3;
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
    }
    #admin-panel button:hover,
    #admin-panel input[type="submit"]:hover {
      background: linear-gradient(90deg,#2980b9 60%,#3498db 100%);
      box-shadow: 0 4px 16px #b3d1f7;
      transform: translateY(-2px) scale(1.04);
    }
    #admin-panel .admin-nav-btn {
      background: linear-gradient(90deg,#6dd5fa 60%,#3498db 100%);
      color: #fff;
      font-size: 1.05rem;
      font-weight: 500;
      border-radius: 8px;
      margin-right: 8px;
      box-shadow: 0 1px 4px #e3eaf3;
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
    }
    #admin-panel .admin-nav-btn:hover {
      background: linear-gradient(90deg,#3498db 60%,#6dd5fa 100%);
      box-shadow: 0 4px 16px #b3d1f7;
      transform: translateY(-2px) scale(1.06);
    }
    /* 保持原有樣式不變 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      color: #333;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      border-bottom: 1px solid #eee;
      margin-bottom: 30px;
    }

    .company-info {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    #company-logo {
      width: 80px;
      height: 80px;
      object-fit: contain;
    }

    .company-info a {
      color: #2c3e50;
      text-decoration: none;
    }

    .company-info a:hover {
      text-decoration: underline;
    }

    .auth-buttons button {
      margin-left: 10px;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: #3498db;
      color: white;
    }

    .auth-buttons button:hover {
      background: #2980b9;
    }

    .google-login-btn {
      background-color: #4285F4 !important;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .google-login-btn img {
      width: 18px;
      height: 18px;
    }

    .date-selector {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }

    .date-selector button {
      padding: 8px 16px;
      background: #f1f1f1;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .slots-container {
      margin: 0 auto;
      max-width: 800px;
    }

    #slots-table {
      width: 100%;
      border-collapse: collapse;
    }

    #slots-table th, #slots-table td {
      padding: 12px;
      text-align: center;
      border: 1px solid #ddd;
    }

    #slots-table th {
      background: #f8f9fa;
    }

    .slot-available {
      background: #e3f2fd;
      cursor: pointer;
    }

    .slot-unavailable {
      background: #f5f5f5;
      color: #999;
    }

    .slot-available:hover {
      background: #bbdefb;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
    }

    .modal-content {
      background: white;
      margin: 15% auto;
      padding: 20px;
      width: 70%;
      max-width: 500px;
      border-radius: 8px;
      position: relative;
    }

    .close-modal {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 28px;
      cursor: pointer;
    }

    #booking-form {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    #booking-form input {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    #booking-form button {
      padding: 10px;
      background: #2ecc71;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    #admin-panel {
      margin-top: 20px;
      display: none;
      max-width: 900px;
      width: 100%;
      background: #f8fafc;
      border-radius: 12px;
      box-shadow: 0 2px 16px #e3eaf3;
      padding: 24px 16px;
      overflow-x: auto;
    }

    .admin-section {
      margin: 24px 0;
      padding: 18px 12px;
      border: 1px solid #e3eaf3;
      border-radius: 10px;
      background: #fff;
      box-shadow: 0 1px 8px #f0f4fa;
      display: flex;
      flex-direction: column;
      gap: 18px;
      min-width: 260px;
      max-width: 100%;
    }

    @media (max-width: 700px) {
      #admin-panel {
        max-width: 100vw;
        padding: 8px 2vw;
        border-radius: 0;
        box-shadow: none;
      }
      .admin-section {
        padding: 10px 2vw;
        border-radius: 0;
        box-shadow: none;
        margin: 12px 0;
      }
      #admin-nav {
        flex-wrap: wrap;
        gap: 6px;
      }
    }

    #admin-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 20px;
      justify-content: flex-start;
    }

    .admin-section form {
      display: flex;
      flex-wrap: wrap;
      gap: 16px 24px;
      align-items: flex-end;
    }

    .admin-section form > div {
      display: flex;
      flex-direction: column;
      min-width: 120px;
      flex: 1 1 180px;
    }

    .admin-section table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.98rem;
      margin-top: 8px;
      overflow-x: auto;
      display: block;
    }
    .admin-section th, .admin-section td {
      padding: 10px 6px;
      text-align: center;
      border: 1px solid #e3eaf3;
      word-break: break-all;
    }
    .admin-section th {
      background: #f8f9fa;
      font-weight: 600;
    }

    /* 讓 admin-panel 內滾動更順暢 */
    #admin-panel::-webkit-scrollbar {
      height: 8px;
      background: #e3eaf3;
      border-radius: 8px;
    }
    #admin-panel::-webkit-scrollbar-thumb {
      background: #b3d1f7;
      border-radius: 8px;
    }

    #slot-form {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 20px;
    }

    /* 美化 admin 區塊 input、button */
    .admin-section input[type="text"],
    .admin-section input[type="date"],
    .admin-section input[type="time"],
    .admin-section input[type="number"],
    .admin-section input[type="tel"],
    .admin-section input[type="email"] {
      padding: 10px;
      border: 1px solid #bfc9d1;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.2s, box-shadow 0.2s;
      outline: none;
      margin: 4px 0;
      background: #f8fafc;
      box-shadow: 0 1px 2px #eee;
    }
    .admin-section input:focus {
      border-color: #3498db;
      box-shadow: 0 2px 8px #cce6ff;
      background: #fff;
    }
    .admin-section button,
    .admin-section input[type="submit"] {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background: linear-gradient(90deg,#3498db 60%,#2980b9 100%);
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      margin: 6px 0;
      box-shadow: 0 2px 8px #e3eaf3;
      transition: background 0.2s, box-shadow 0.2s;
    }
    .admin-section button:hover,
    .admin-section input[type="submit"]:hover {
      background: linear-gradient(90deg,#2980b9 60%,#3498db 100%);
      box-shadow: 0 4px 16px #b3d1f7;
    }
    /* 行動按鈕特殊色 */
    .action-btn {
      padding: 7px 16px;
      margin: 0 5px;
      border: none;
      border-radius: 6px;
      font-size: 0.95rem;
      cursor: pointer;
      box-shadow: 0 1px 4px #e3eaf3;
      transition: background 0.2s, box-shadow 0.2s;
    }
    .edit-btn {
      background: linear-gradient(90deg,#3498db 60%,#2980b9 100%);
      color: white;
    }
    .edit-btn:hover {
      background: linear-gradient(90deg,#2980b9 60%,#3498db 100%);
      box-shadow: 0 2px 8px #b3d1f7;
    }
    .delete-btn {
      background: #e74c3c !important;
      color: #fff !important;
      border: none;
      box-shadow: 0 2px 8px #f7b3b3;
    }
    .delete-btn:hover {
      background: #c0392b !important;
      color: #fff !important;
      box-shadow: 0 4px 16px #f7b3b3;
    }
    .copy-btn {
      background: #FFD700 !important;
      color: #fff !important;
      border: none;
      box-shadow: 0 2px 8px #ffe3b3;
    }
    .copy-btn:hover {
      background: #FFC300 !important;
      color: #fff !important;
      box-shadow: 0 4px 16px #ffe3b3;
    }

  </style>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script src="https://cdn.staticfile.net/translate.js/3.1.7/translate.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
  <script src="https://64071181.github.io/mokJsapi/a.js">//琪琪修改</script>



</head>
















































<body>
  <p id="translate"></p>
  <!-- 頂部導航 -->
  <header>
    <div class="company-info">
      <img src="" alt="公司Logo" id="company-logo">
      <div>
        <h1 id="company-name">公司名稱</h1>
        <p>
          <a href="" target="_blank" id="company-address">公司地址</a> | 
          <a href="" id="company-phone">聯繫電話</a>
        </p>
      </div>
    </div>
    <div class="auth-buttons">
      <button id="login-btn" class="google-login-btn">
        <i class="fab fa-google"></i> 登入
      </button>
      <button id="logout-btn" style="display:none">退出</button>
      <button id="admin-btn" style="display:none">管理後臺</button>
    </div>
  </header>

  <!-- 主內容區 -->
  <main>
    <!-- 日期選擇器 -->
    <div class="date-selector">
      <button id="prev-date">&lt;</button>
      <h2 id="current-date"></h2>
      <button id="next-date">&gt;</button>
    </div>

    <!-- 時段表格 -->
    <div class="slots-container">
      <table id="slots-table">
        <thead>
          <tr>
            <th>時段</th>
            <th>價格</th>
            <th>剩餘名額</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody id="slots-body">
          <!-- 時段數據將通過JS動態生成 -->
        </tbody>
      </table>
    </div>
  </main>
  <!-- 廣告區塊 -->
  <div id="ads-container" style="margin: 30px 0; display: flex; flex-wrap: wrap; gap: 20px;"></div>






















  <!-- 預約彈窗 -->
  <div id="booking-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal">×</span>
      <h3>預約時段</h3>
      <p id="selected-slot-info"></p>
      <form id="booking-form">
        <input type="hidden" id="slot-id">
        <div>
          <label for="name">姓名：</label>
          <input type="text" id="name" required="">
        </div>
        <div>
          <label for="phone">電話：</label>
          <input type="tel" id="phone" required="">
        </div>
        <button type="submit">確認預約</button>
      </form>
    </div>
  </div>

  <!-- 管理員頁面 -->
  <div id="admin-panel">
    <h2>管理後臺</h2>
    <button id="back-btn">返回首頁</button>
    <!-- 管理後台分頁式導航 -->
    <div id="admin-nav" style="display:flex;gap:10px;margin-bottom:20px;">
  <button class="admin-nav-btn" data-target="company-section">公司資訊管理</button>
  <button class="admin-nav-btn" data-target="slot-section">時段管理</button>
  <button class="admin-nav-btn" data-target="record-section">預約記錄查詢</button>
  <button class="admin-nav-btn" data-target="ads-section">廣告管理</button>
  <button class="admin-nav-btn" data-target="user-section">會員管理</button>
    </div>

    <!-- 公司資訊管理 -->
    <div class="admin-section" id="company-section">
      <h3>公司資訊管理</h3>
      <form id="company-form">
        <div>
          <label for="admin-company-name">公司名稱：</label>
          <input type="text" id="admin-company-name" required value="">
        </div>
        <div>
          <label for="admin-company-address">地址：</label>
          <input type="text" id="admin-company-address" required value="">
        </div>
        <div>
          <label for="admin-company-phone">電話：</label>
          <input type="text" id="admin-company-phone" required value="">
        </div>
        <div>
          <label for="admin-company-logo">Logo 圖片網址：</label>
          <input type="text" id="admin-company-logo" value="">
        </div>
        <button type="submit">保存公司資訊</button>
      </form>
    </div>
    
    <!-- 時段管理 -->
    <div class="admin-section" id="slot-section">
      <h3>編輯可預約時段</h3>
      <form id="slot-form">
        <input type="hidden" id="edit-slot-id">
        <div>
          <label for="slot-date">日期：</label>
          <input type="date" id="slot-date" required="">
        </div>
        <div>
          <label for="slot-time">時間：</label>
          <input type="time" id="slot-time" required="">
        </div>
        <div>
          <label for="slot-price">價格：</label>
          <input type="number" id="slot-price" min="0" required="">
        </div>
        <div>
          <label for="slot-max">最大人數：</label>
          <input type="number" id="slot-max" min="1" value="5" required="">
        </div>
        <button type="submit" id="save-slot">保存時段</button>
      </form>

      <!-- 批量新增時段 -->
      <h4 style="margin-top:30px;">批量新增時段</h4>
      <form id="batch-slot-form" style="margin-bottom:20px;">
        <div>
          <label>起始日期：</label>
          <input type="date" id="batch-start-date" required>
          <label>結束日期：</label>
          <input type="date" id="batch-end-date" required>
        </div>
        <div>
          <label>起始時間：</label>
          <input type="time" id="batch-start-time" required>
          <label>結束時間：</label>
          <input type="time" id="batch-end-time" required>
        </div>
        <div>
          <label>間隔(分鐘)：</label>
          <input type="number" id="batch-interval" min="1" value="15" required>
        </div>
        <div>
          <label>價格：</label>
          <input type="number" id="batch-price" min="0" required>
          <label>最大人數：</label>
          <input type="number" id="batch-max" min="1" value="5" required>
        </div>
        <button type="submit">批量新增</button>
      </form>
      
      <!-- 時段列表 -->
      <div class="admin-slots">
        <h4>現有時段</h4>
        <div style="margin-bottom:10px;">
          <label>篩選日期：</label>
          <input type="date" id="admin-slots-filter-date">
          <button id="admin-slots-filter-btn">查詢</button>
          <button id="admin-slots-filter-reset">全部</button>
        </div>
        <table id="admin-slots-table">
          <thead>
            <tr>
              <th>日期</th>
              <th>時間</th>
              <th>價格</th>
              <th>最大人數</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="admin-slots-body">
          </tbody>
        </table>
      </div>
    </div>

    <!-- 預約記錄查詢 -->
    <div class="admin-section" id="record-section">
      <h3>預約記錄查詢</h3>
      <select id="record-filter">
        <option value="day">今日</option>
        <option value="month">本月</option>
        <option value="year">今年</option>
      </select>
      <table id="records-table">
        <thead>
          <tr>
            <th>日期</th>
            <th>時間</th>
            <th>姓名</th>
            <th>電話</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody id="records-body">
        </tbody>
      </table>
    </div>

      <!-- 廣告管理 -->
      <div class="admin-section" id="ads-section">
        <h3>廣告管理</h3>
        <form id="ads-form">
          <label for="ads-count">廣告數量：</label>
          <input type="number" id="ads-count" min="1" value="1" style="width:60px;">
          <div id="ads-fields"></div>
          <button type="submit">保存廣告</button>
        </form>
      </div>
  </div>



  <!-- 在管理面板中添加会员管理区块 -->
  <div class="admin-section" id="user-section">
    <h3>會員管理</h3>
    <div style="margin-bottom: 15px;">
      <label for="user-filter">篩選：</label>
      <select id="user-filter">
        <option value="all">所有會員</option>
        <option value="admin">管理員</option>
        <option value="user">一般會員</option>
      </select>
    </div>
    <table id="users-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>姓名</th>
          <th>電子郵件</th>
          <th>角色</th>
          <th>註冊日期</th>
          <th>最後登入</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody id="users-body">
        <!-- 会员数据将通过JS动态生成 -->
      </tbody>
    </table>
  </div>










    <div id="ContactAKI" class="ContactAKI"><!-- JS _顯示聯莫 --></div>
    <div class="copyright">
        <p class="mokJsApi_copyright">版權</p>
    </div>
    <div class="scroll-top" id="scrollTop" onclick="scrollToTop()">↑</div>













































  <script>
    // Firebase 配置（請替換為你的實際配置）
    const firebaseConfig = {
      apiKey: "AIzaSyCTkeDPWcaFnkW5tAZGw7VSRErgzYxA-jE",
      authDomain: "bookingsys-57530.firebaseapp.com",
      projectId: "bookingsys-57530",
      storageBucket: "bookingsys-57530.firebasestorage.app",
      messagingSenderId: "490656093093",
      appId: "1:490656093093:web:886418bbef4a2169514e4c",
      measurementId: "G-VM9F2DXGSK"
    };

    // 初始化 Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // 全局變量
    let currentUser = null;
    let currentDate = new Date();
    let selectedSlotId = null;

    // DOM 元素
    const loginBtn = document.getElementById('login-btn');
    const logoutBtn = document.getElementById('logout-btn');
    const adminBtn = document.getElementById('admin-btn');
    const adminPanel = document.getElementById('admin-panel');
    const backBtn = document.getElementById('back-btn');
    const currentDateEl = document.getElementById('current-date');
    const slotsBody = document.getElementById('slots-body');
    const bookingModal = document.getElementById('booking-modal');
    const bookingForm = document.getElementById('booking-form');
    const slotIdInput = document.getElementById('slot-id');
    const selectedSlotInfo = document.getElementById('selected-slot-info');
    const companyNameEl = document.getElementById('company-name');
    const companyLogoEl = document.getElementById('company-logo');
    const companyAddressEl = document.getElementById('company-address');
    const companyPhoneEl = document.getElementById('company-phone');







// 設置編輯時段表單的默認日期和時間為今日現在
function setDefaultSlotDateTime() {
  const now = new Date(); // 獲取當前時間
  
  // 格式化日期為 YYYY-MM-DD（符合 input[type="date"] 要求）
  const year = now.getFullYear();
  const month = String(now.getMonth() + 1).padStart(2, '0'); // 月份從 0 開始，需 +1 並補零
  const day = String(now.getDate()).padStart(2, '0');
  const defaultDate = `${year}-${month}-${day}`;
  
  // 格式化時間為 HH:MM（符合 input[type="time"] 要求）
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const defaultTime = `${hours}:${minutes}`;
  
  // 設置表單默認值
  document.getElementById('slot-date').value = defaultDate;
  document.getElementById('slot-time').value = defaultTime;

  // 新增：讀取本地存儲的上次價格並填充
  const lastPrice = localStorage.getItem('lastSlotPrice');
  if (lastPrice !== null) { // 如果存在上次價格
    document.getElementById('slot-price').value = lastPrice; // 填充到輸入框
  }
  // 如果沒有上次價格，保持原有默認值（如 <input value="5">）
}






    // 初始化頁面
    function initApp() {
      // 監聽登錄狀態
      auth.onAuthStateChanged(user => {
        if (user) {
          currentUser = user;
          loginBtn.style.display = 'none';
          logoutBtn.style.display = 'inline-block';
          checkUserRole(); // 檢查用戶角色
          loadCompanySettings();
          loadSlots();
        } else {
          currentUser = null;
          loginBtn.style.display = 'inline-block';
          logoutBtn.style.display = 'none';
          adminBtn.style.display = 'none';
          adminPanel.style.display = 'none';
          loadCompanySettings();
          loadSlots();
        }
      });

      // 日期切換
      document.getElementById('prev-date').addEventListener('click', () => {
        currentDate.setDate(currentDate.getDate() - 1);
        loadSlots();
      });
      document.getElementById('next-date').addEventListener('click', () => {
        currentDate.setDate(currentDate.getDate() + 1);
        loadSlots();
      });

      // Google登錄
      loginBtn.addEventListener('click', () => {
        const provider = new firebase.auth.GoogleAuthProvider();
        provider.setCustomParameters({
          prompt: 'select_account'
        });
        auth.signInWithPopup(provider)
          .catch(err => alert('登錄失敗：' + err.message));
      });

      logoutBtn.addEventListener('click', () => {
        auth.signOut();
      });

      // 新增：頁面加載時設置編輯時段表單的默認日期和時間
      setDefaultSlotDateTime();

      adminBtn.addEventListener('click', () => {
  document.querySelector('main').style.display = 'none';
  adminPanel.style.display = 'block';
  loadAdminSlots();
  loadRecords('day');
  loadAdminCompanyForm(); // 進入後台時載入公司資料
      });

      backBtn.addEventListener('click', () => {
        document.querySelector('main').style.display = 'block';
        adminPanel.style.display = 'none';
      });

      bookingForm.addEventListener('submit', (e) => {
        e.preventDefault();
        if (!currentUser) {
          alert('請先登錄');
          return;
        }

        const name = document.getElementById('name').value;
        const phone = document.getElementById('phone').value;
        
        db.collection('appointments').add({



          slotId: selectedSlotId,
          userId: firebase.auth().currentUser.uid, // 必須與登錄用戶uid一致
          name,
          phone,
          createdAt: firebase.firestore.Timestamp.now()
        }).then(() => {
          db.collection('slots').doc(selectedSlotId).update({
            currentUsers: firebase.firestore.FieldValue.increment(1)
            
          }).then(() => {
            alert('預約成功！');
            bookingModal.style.display = 'none';
            bookingForm.reset();
            sendWhatsappNotification(name, phone);
            loadSlots();
          });
        }).catch(err => alert('預約失敗：' + err.message));
      });

      document.getElementById('slot-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const slotId = document.getElementById('edit-slot-id').value;
        const date = document.getElementById('slot-date').value;
        const time = document.getElementById('slot-time').value;
        const price = Number(document.getElementById('slot-price').value);
        const maxUsers = Number(document.getElementById('slot-max').value);

        // 新增：保存價格到本地存儲（鍵名為 lastSlotPrice）
        localStorage.setItem('lastSlotPrice', price); // 存儲數值類型

        const slotData = { date, time, price, maxUsers, currentUsers: 0, isActive: true };

        if (slotId) {
          db.collection('slots').doc(slotId).update(slotData)
            .then(() => alert('更新成功'));
        } else {
          db.collection('slots').add(slotData)
            .then(() => alert('創建成功'));
        }

        document.getElementById('slot-form').reset();
        document.getElementById('edit-slot-id').value = '';
        loadAdminSlots();
      });

      document.getElementById('record-filter').addEventListener('change', (e) => {
        loadRecords(e.target.value);
      });

      // 管理員時段篩選事件
      // 新增：篩選日期預設為今日
      const adminSlotsFilterDate = document.getElementById('admin-slots-filter-date');
      if (adminSlotsFilterDate) {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        adminSlotsFilterDate.value = `${year}-${month}-${day}`;
      }
      document.getElementById('admin-slots-filter-btn').addEventListener('click', function() {
        loadAdminSlots();
      });
      document.getElementById('admin-slots-filter-reset').addEventListener('click', function() {
        adminSlotsFilterDate.value = '';
        loadAdminSlots();
      });





  // 会员管理筛选
  document.getElementById('user-filter').addEventListener('change', function() {
    loadUsers(this.value);
  });

  // 在进入后台时加载会员数据
  adminBtn.addEventListener('click', () => {
    document.querySelector('main').style.display = 'none';
    adminPanel.style.display = 'block';
    loadAdminSlots();
    loadRecords('day');
    loadAdminCompanyForm();
    loadUsers('all'); // 添加这行加载会员数据
  });  
    }

// 加载会员数据
function loadUsers(filter = 'all') {
  const usersBody = document.getElementById('users-body');
  usersBody.innerHTML = '<tr><td colspan="7">載入中...</td></tr>';
  
  let query = db.collection('users');
  
  if (filter === 'admin') {
    query = query.where('role', '==', 'admin');
  } else if (filter === 'user') {
    query = query.where('role', '==', 'user');
  }
  
  query.orderBy('createdAt', 'desc').get()
    .then(snapshot => {
      usersBody.innerHTML = '';
      
      if (snapshot.empty) {
        usersBody.innerHTML = '<tr><td colspan="7">暫無會員資料</td></tr>';
        return;
      }
      
      snapshot.forEach(doc => {
        const user = doc.data();
        const createdAt = user.createdAt ? user.createdAt.toDate().toLocaleString() : '未知';
        const lastLogin = user.lastLogin ? user.lastLogin.toDate().toLocaleString() : '未知';
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${doc.id.substring(0, 8)}</td>
          <td>${user.name || '-'}</td>
          <td>${user.email || '-'}</td>
          <td>
            <select class="user-role" data-id="${doc.id}" ${user.uid === currentUser?.uid ? 'disabled' : ''}>
              <option value="user" ${user.role === 'user' ? 'selected' : ''}>一般會員</option>
              <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>管理員</option>
            </select>
          </td>
          <td>${createdAt}</td>
          <td>${lastLogin}</td>
          <td>
            <button class="action-btn delete-btn" data-id="${doc.id}" 
                    ${user.uid === currentUser?.uid ? 'disabled' : ''}>
              刪除
            </button>
          </td>
        `;
        usersBody.appendChild(row);
      });
      
      // 添加角色变更事件监听
      document.querySelectorAll('.user-role').forEach(select => {
        select.addEventListener('change', function() {
          const userId = this.getAttribute('data-id');
          const newRole = this.value;
          updateUserRole(userId, newRole);
        });
      });
      
      // 添加删除事件监听
      document.querySelectorAll('#users-body .delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const userId = this.getAttribute('data-id');
          if (confirm('確定要刪除此會員嗎？此操作無法復原！')) {
            deleteUser(userId);
          }
        });
      });
    })
    .catch(err => {
      console.error('加載會員失敗:', err);
      usersBody.innerHTML = '<tr><td colspan="7">載入失敗</td></tr>';
    });
}





// 更新用户角色
function updateUserRole(userId, newRole) {
  db.collection('users').doc(userId).update({ role: newRole })
    .then(() => {
      alert('會員角色已更新');
      // 如果修改的是当前用户，刷新页面
      if (userId === currentUser?.uid) {
        location.reload();
      }
    })
    .catch(err => {
      console.error('更新角色失敗:', err);
      alert('更新失敗: ' + err.message);
    });
}

// 删除用户
function deleteUser(userId) {
  db.collection('users').doc(userId).delete()
    .then(() => {
      alert('會員已刪除');
      loadUsers(document.getElementById('user-filter').value);
    })
    .catch(err => {
      console.error('刪除會員失敗:', err);
      alert('刪除失敗: ' + err.message);
    });
}







    // 修復的用戶角色檢查函數 - 確保只有第一個用戶成為管理員
function checkUserRole() {
  if (!currentUser) return;

  // 步驟1：先檢查當前用戶是否已存在
  db.collection('users').doc(currentUser.uid).get()
    .then(userDoc => {
      if (userDoc.exists) {
        // 用戶已存在，直接讀取自己的角色
        const role = userDoc.data().role;
        adminBtn.style.display = role === 'admin' ? 'inline-block' : 'none';
        return;
      }

      // 步驟2：查詢用戶集合數量（僅判斷是否為空，不讀取具體數據）
      db.collection('users').limit(1).get() // 只查1條，判斷是否為空
        .then(usersSnapshot => {
          // 判斷是否為第一個用戶（集合為空）
          const isFirstUser = usersSnapshot.empty;
          const userRole = isFirstUser ? 'admin' : 'user';

          // 步驟3：創建當前用戶的記錄
          db.collection('users').doc(currentUser.uid).set({
            email: currentUser.email,
            name: currentUser.displayName,
            role: userRole,
            createdAt: firebase.firestore.Timestamp.now()
          })
          .then(() => {
            adminBtn.style.display = userRole === 'admin' ? 'inline-block' : 'none';
            if (isFirstUser) {
              alert('恭喜！您是第一個用戶，已自動成為管理員。');
            }
          })
          .catch(err => {
            console.error('創建用戶記錄失敗:', err);
            alert('設置用戶角色時出錯: ' + err.message);
          });
        })
        .catch(err => {
          console.error('查詢用戶數量失敗:', err);
          alert('檢查用戶數量時出錯: ' + err.message);
        });
    })
    .catch(err => {
      console.error('獲取當前用戶信息失敗:', err);
      alert('獲取用戶信息時出錯: ' + err.message);
    });
}






    // 加載可預約時段
    function loadSlots() {
      const dateStr = currentDate.toISOString().split('T')[0];
      currentDateEl.textContent = dateStr;
      slotsBody.innerHTML = '';

      db.collection('slots').where('date', '==', dateStr).get()
        .then(snapshot => {
          if (snapshot.empty) {
            slotsBody.innerHTML = '<tr><td colspan="4">暫無可用時段</td></tr>';
            return;
          }
          // 依時間排序
          const slotsArr = [];
          snapshot.forEach(doc => {
            const slot = doc.data();
            slot._id = doc.id;
            slotsArr.push(slot);
          });
          slotsArr.sort((a, b) => a.time.localeCompare(b.time));
          const now = new Date();
          const todayStr = now.toISOString().split('T')[0];
          const nowMinutes = now.getHours() * 60 + now.getMinutes();
          slotsArr.forEach(slot => {
              let slotMinutes = 0;
              if (slot.time) {
                const [h, m] = slot.time.split(':');
                slotMinutes = parseInt(h) * 60 + parseInt(m);
              }
            // 判斷是否已過期
            const isToday = slot.date === todayStr;
            const isPast = isToday && slotMinutes < nowMinutes;
            const isAvailable = slot.currentUsers < slot.maxUsers && slot.isActive && !isPast;
            const row = document.createElement('tr');
            row.className = isAvailable ? 'slot-available' : 'slot-unavailable';
            row.innerHTML = `
              <td>${slot.time}</td>
              <td>${slot.price}元</td>
                <td>${isPast ? '0' : (slot.maxUsers - slot.currentUsers)}/${slot.maxUsers}</td>
              <td>
                ${isPast ? '已滿' : (isAvailable ? `<button class="book-btn" data-id="${slot._id}" data-time="${slot.time}" data-price="${slot.price}">預約</button>` : '已滿')}
              </td>
            `;
            slotsBody.appendChild(row);
          });
          document.querySelectorAll('.book-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              if (!currentUser) {
                alert('請先登錄');
                return;
              }
              selectedSlotId = btn.getAttribute('data-id');
              slotIdInput.value = selectedSlotId;
              selectedSlotInfo.textContent = `時段：${btn.getAttribute('data-time')}，價格：${btn.getAttribute('data-price')}元`;
              bookingModal.style.display = 'block';
            });
          });
        });
    }

    // 其他函數保持不變...
    // 批量新增時段功能
    document.getElementById('batch-slot-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const startDate = document.getElementById('batch-start-date').value;
      const endDate = document.getElementById('batch-end-date').value;
      const startTime = document.getElementById('batch-start-time').value;
      const endTime = document.getElementById('batch-end-time').value;
      const interval = parseInt(document.getElementById('batch-interval').value);
      const price = parseInt(document.getElementById('batch-price').value);
      const maxUsers = parseInt(document.getElementById('batch-max').value);

      // 日期迴圈
      let currentDate = new Date(startDate);
      const lastDate = new Date(endDate);
      let batchCount = 0;
      while (currentDate <= lastDate) {
        const dateStr = currentDate.toISOString().split('T')[0];
        // 時間迴圈
        let [startH, startM] = startTime.split(':').map(Number);
        let [endH, endM] = endTime.split(':').map(Number);
        let totalStart = startH * 60 + startM;
        let totalEnd = endH * 60 + endM;
        for (let t = totalStart; t < totalEnd; t += interval) {
          const h = String(Math.floor(t / 60)).padStart(2, '0');
          const m = String(t % 60).padStart(2, '0');
          const timeStr = `${h}:${m}`;
          db.collection('slots').add({
            date: dateStr,
            time: timeStr,
            price,
            maxUsers,
            currentUsers: 0,
            isActive: true
          });
          batchCount++;
        }
        currentDate.setDate(currentDate.getDate() + 1);
      }
      alert(`已批量新增 ${batchCount} 個時段！`);
      loadAdminSlots();
    });
    function loadAdminSlots() {
      const adminSlotsBody = document.getElementById('admin-slots-body');
      adminSlotsBody.innerHTML = '';
      const filterDate = document.getElementById('admin-slots-filter-date')?.value;
      let query = db.collection('slots').orderBy('date').orderBy('time');
      if (filterDate) {
        query = query.where('date', '==', filterDate);
      }
      query.get()
        .then(snapshot => {
          snapshot.forEach(doc => {
            const slot = doc.data();
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${slot.date}</td>
              <td>${slot.time}</td>
              <td>${slot.price}元</td>
              <td>${slot.maxUsers}</td>
              <td>
                <button class="action-btn edit-btn" data-id="${doc.id}">編輯</button>
                <button class="action-btn delete-btn" data-id="${doc.id}">刪除</button>
                <button class="action-btn copy-btn" data-id="${doc.id}">复制</button>
              </td>
            `;
            adminSlotsBody.appendChild(row);
          });
          document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              const slotId = btn.getAttribute('data-id');
              copySlot(slotId);
            });
          });
          document.querySelectorAll('.edit-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              const slotId = btn.getAttribute('data-id');
              editSlot(slotId);
            });
          });
          document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              const slotId = btn.getAttribute('data-id');
              deleteSlot(slotId);
            });
          });
        })
        .catch(err => {
          console.error('加載時段失敗：', err);
        });
    }

  // 复制时段数据到表单
  function copySlot(slotId) {
    db.collection('slots').doc(slotId).get()
      .then(doc => {
        if (!doc.exists) {
          alert('时段数据不存在');
          return;
        }
        const slot = doc.data();
        
        // 清空编辑ID（确保复制后保存为新时段，而非更新原时段）
        document.getElementById('edit-slot-id').value = '';
        
        // 填充原时段数据到表单
        document.getElementById('slot-date').value = slot.date;
        document.getElementById('slot-time').value = slot.time;
        document.getElementById('slot-price').value = slot.price;
        document.getElementById('slot-max').value = slot.maxUsers;
        
        // 可选：自动滚动到表单位置，方便修改
        document.getElementById('slot-form').scrollIntoView({ behavior: 'smooth' });
        
        alert('已复制时段数据，请修改后保存');
      })
      .catch(err => {
        console.error('复制时段失败：', err.message);
        alert('复制失败：' + err.message);
      });
  }


    function loadRecords(filter) {
      const recordsBody = document.getElementById('records-body');
      recordsBody.innerHTML = '';
      let startDate, endDate;

      if (filter === 'day') {
        startDate = new Date();
        startDate.setHours(0, 0, 0, 0);
        endDate = new Date();
        endDate.setHours(23, 59, 59, 999);
      } else if (filter === 'month') {
        startDate = new Date();
        startDate.setDate(1);
        startDate.setHours(0, 0, 0, 0);
        endDate = new Date();
        endDate.setMonth(endDate.getMonth() + 1);
        endDate.setDate(0);
        endDate.setHours(23, 59, 59, 999);
      } else if (filter === 'year') {
        startDate = new Date();
        startDate.setMonth(0, 1);
        startDate.setHours(0, 0, 0, 0);
        endDate = new Date();
        endDate.setMonth(11, 31);
        endDate.setHours(23, 59, 59, 999);
      }

      db.collection('appointments')
        .where('createdAt', '>=', firebase.firestore.Timestamp.fromDate(startDate))
        .where('createdAt', '<=', firebase.firestore.Timestamp.fromDate(endDate))
        .orderBy('createdAt', 'desc')
        .get()
        .then(snapshot => {
          if (snapshot.empty) {
            recordsBody.innerHTML = '<tr><td colspan="5">暫無記錄</td></tr>';
            return;
          }

          snapshot.forEach(doc => {
            const appointment = doc.data();
            db.collection('slots').doc(appointment.slotId).get()
              .then(slotDoc => {
                const slot = slotDoc.data();
                const row = document.createElement('tr');
                row.innerHTML = `
                  <td>${slot.date}</td>
                  <td>${slot.time}</td>
                  <td>${appointment.name}</td>
                  <td>${appointment.phone}</td>
                  <td>
                    <button class="action-btn delete-btn" data-id="${doc.id}" data-slotid="${appointment.slotId}">刪除</button>
                  </td>
                `;
                recordsBody.appendChild(row);

                row.querySelector('.delete-btn').addEventListener('click', (e) => {
                  if (confirm('確定刪除該預約？')) {
                    const slotId = e.target.getAttribute('data-slotid');
                    db.collection('slots').doc(slotId).update({
                      currentUsers: firebase.firestore.FieldValue.increment(-1)
                    }).then(() => {
                      db.collection('appointments').doc(doc.id).delete()
                        .then(() => loadRecords(filter));
                    });
                  }
                });
              });
          });
        });
    }

    function loadCompanySettings() {
      db.collection('settings').doc('company').get()
        .then(doc => {
          if (doc.exists) {
            const settings = doc.data();
            companyNameEl.textContent = settings.companyName || '公司名稱';
            companyLogoEl.src = settings.logo || '';
            companyAddressEl.textContent = settings.address || '公司地址';
            companyAddressEl.href = `https://www.google.com/maps/search/${settings.address}`;
            companyPhoneEl.textContent = settings.phone || '聯繫電話';
            companyPhoneEl.href = `https://wa.me/${settings.phone}?text=你好，我想查詢`;
          } else {
            db.collection('settings').doc('company').set({
              companyName: '莫氏髮型',
              logo: 'https://z.wiki/u/MQQHJO',
              address: '大角咀',
              phone: '98672794'
            });
          }
        });
    }

    function sendWhatsappNotification(name, phone) {
      db.collection('settings').doc('company').get()
        .then(doc => {
          const adminPhone = doc.data().phone;
          const message = `新預約通知：姓名 ${name}，電話 ${phone}，時段 ${selectedSlotInfo.textContent}`;
          const encodedMsg = encodeURIComponent(message);
          window.open(`https://wa.me/${adminPhone}?text=${encodedMsg}`, '_blank');
        });
    }

    document.querySelector('.close-modal').addEventListener('click', () => {
      bookingModal.style.display = 'none';
    });

    // 廣告管理功能
    function renderAdsFields(count, adsData = []) {
      const adsFields = document.getElementById('ads-fields');
      adsFields.innerHTML = '';
      for (let i = 0; i < count; i++) {
        const img = adsData[i]?.img || '';
        const url = adsData[i]?.url || '';
        adsFields.innerHTML += `
          <div style="margin-bottom:10px;">
            <label>圖片網址：</label>
            <input type="text" name="ad-img-${i}" value="${img}" style="width:250px;">
            <label>外部連結：</label>
            <input type="text" name="ad-url-${i}" value="${url}" style="width:250px;">
          </div>
        `;
      }
    }

    // 公司資訊管理功能
    function loadAdminCompanyForm() {
      db.collection('settings').doc('company').get().then(doc => {
        if (doc.exists) {
          const data = doc.data();
          document.getElementById('admin-company-name').value = data.companyName || '';
          document.getElementById('admin-company-address').value = data.address || '';
          document.getElementById('admin-company-phone').value = data.phone || '';
          document.getElementById('admin-company-logo').value = data.logo || '';
        } else {
          document.getElementById('admin-company-name').value = '';
          document.getElementById('admin-company-address').value = '';
          document.getElementById('admin-company-phone').value = '';
          document.getElementById('admin-company-logo').value = '';
        }
      });
    }

    document.getElementById('company-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const companyName = document.getElementById('admin-company-name').value.trim();
      const address = document.getElementById('admin-company-address').value.trim();
      const phone = document.getElementById('admin-company-phone').value.trim();
      const logo = document.getElementById('admin-company-logo').value.trim();
      db.collection('settings').doc('company').update({
        companyName,
        address,
        phone,
        logo
      }).then(() => {
        alert('公司資訊已保存');
        loadCompanySettings(); // 前台同步更新
      });
    });

    // 初始化時載入公司資訊表單
    function initAppWithAds() {
      initApp();
      loadAdsSettings();
      loadAdminCompanyForm();
      // 顯示管理員面板時自動載入公司資料
      if (adminPanel) {
        adminPanel.addEventListener('show', loadAdminCompanyForm);
      }
    }

    function loadAdsSettings() {
      db.collection('settings').doc('ads').get().then(doc => {
        let ads = [];
        if (doc.exists) {
          ads = doc.data().ads || [];
        }
        const adsCount = ads.length || 1;
        document.getElementById('ads-count').value = adsCount;
        renderAdsFields(adsCount, ads);
        renderAds(ads);
      });
    }

    function renderAds(ads) {
      const adsContainer = document.getElementById('ads-container');
      adsContainer.innerHTML = '';
      ads.forEach(ad => {
        if (ad.img && ad.url) {
          adsContainer.innerHTML += `
            <a href="${ad.url}" target="_blank" style="display:inline-block;">
              <img src="${ad.img}" alt="廣告" style="width:220px; height:120px; object-fit:cover; border-radius:8px; box-shadow:0 2px 8px #ccc;">
            </a>
          `;
        }
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      const adsCountInput = document.getElementById('ads-count');
      adsCountInput.addEventListener('change', () => {
        const count = Number(adsCountInput.value);
        renderAdsFields(count);
      });
      loadAdsSettings();
    });

    document.getElementById('ads-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const count = Number(document.getElementById('ads-count').value);
      const ads = [];
      for (let i = 0; i < count; i++) {
        const img = document.querySelector(`[name='ad-img-${i}']`).value.trim();
        const url = document.querySelector(`[name='ad-url-${i}']`).value.trim();
        ads.push({ img, url });
      }
      db.collection('settings').doc('ads').set({ ads }).then(() => {
        alert('廣告已保存');
        renderAds(ads);
      });
    });

    // 初始化時載入廣告
    function initAppWithAds() {
      initApp();
      loadAdsSettings();
    }
    window.onload = function() {
  // 管理後台導航切換
  document.querySelectorAll('.admin-nav-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      document.querySelectorAll('.admin-section').forEach(sec => {
        sec.style.display = 'none';
      });
      document.getElementById(btn.dataset.target).style.display = 'block';
    });
  });
  // 預設顯示公司資訊管理
  document.querySelectorAll('.admin-section').forEach(sec => { sec.style.display = 'none'; });
  document.getElementById('company-section').style.display = 'block';
  // 自動執行初始化，確保 firebase 資料載入
  initApp();
}

    /*

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 用戶集合規則
    match /users/{uid} {
      allow read: if request.auth != null && request.auth.uid == uid;
      allow create: if request.auth != null && request.auth.uid == uid;
      allow update: if isAdmin();
    }

    // 合併重複的用戶集合查詢規則（原代碼有兩個重複塊）
    match /users/{uid=**} {
      allow list: if request.auth != null;
    }

    // 調整 slots 規則：允許普通用戶更新 currentUsers（僅增加）
    match /slots/{slotId} {
      allow read: if true;
      // 管理員可執行所有操作；普通用戶僅允許增加 currentUsers（且不修改其他字段）
      allow create, delete: if isAdmin();
      allow update: if isAdmin() || (
        request.auth != null &&
        // 確保僅增加 currentUsers（預約時人數+1）
        request.resource.data.currentUsers == resource.data.currentUsers + 1 &&
        // 確保其他字段未被篡改（日期、時間、價格等不變）
        request.resource.data.date == resource.data.date &&
        request.resource.data.time == resource.data.time &&
        request.resource.data.price == resource.data.price &&
        request.resource.data.maxUsers == resource.data.maxUsers &&
        request.resource.data.isActive == resource.data.isActive
      );
    }

    match /appointments/{appointmentId} {
      allow read: if request.auth != null && (isAdmin() || resource.data.userId == request.auth.uid);
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;
      allow delete: if isAdmin();
    }

    match /settings/{settingId} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // 管理員判斷函數
    function isAdmin() {
      return request.auth != null && 
             exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == "admin";
    }
  }
}

    */
  </script>














    <script>

        translate.service.use('client.edge'); //設置機器翻譯服務通道，直接客戶端本身，不依賴服務端 。相關說明參考 http://translate.zvo.cn/43086.html
        translate.execute();//進行翻譯 


        function Start() {
            // 顯示聯莫
            const 聯莫 = ['moksurky@gmail.com','https://wa.me/85264071181/','https://i.meee.com.tw/atcX6QM.png','https://www.instagram.com/moksurky2025/','https://line.me/ti/p/UlSPd7p9zh/','https://www.facebook.com/aki.mok.10/','http://t.me/mokaki/','https://github.com/GoldComeHK/GoldComeHK.github.io'
            ];
            _顯示聯莫(聯莫);
        }
        琪琪修改('https://64071181.github.io/')




    </script>
</body>
</html>